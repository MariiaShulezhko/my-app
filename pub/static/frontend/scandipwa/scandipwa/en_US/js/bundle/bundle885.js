require.config({"config": {
        "jsbuild":{"Magento_Tinymce3/tiny_mce/themes/advanced/editor_template_src.js":"/**\n * editor_template_src.js\n *\n * Copyright 2009, Moxiecode Systems AB\n * Released under LGPL License.\n *\n * License: http://tinymce.moxiecode.com/license\n * Contributing: http://tinymce.moxiecode.com/contributing\n */\n\n(function(tinymce) {\n\tvar DOM = tinymce.DOM, Event = tinymce.dom.Event, extend = tinymce.extend, each = tinymce.each, Cookie = tinymce.util.Cookie, lastExtID, explode = tinymce.explode;\n\n\t// Tell it to load theme specific language pack(s)\n\ttinymce.ThemeManager.requireLangPack('advanced');\n\n\ttinymce.create('tinymce.themes.AdvancedTheme', {\n\t\tsizes : [8, 10, 12, 14, 18, 24, 36],\n\n\t\t// Control name lookup, format: title, command\n\t\tcontrols : {\n\t\t\tbold : ['bold_desc', 'Bold'],\n\t\t\titalic : ['italic_desc', 'Italic'],\n\t\t\tunderline : ['underline_desc', 'Underline'],\n\t\t\tstrikethrough : ['striketrough_desc', 'Strikethrough'],\n\t\t\tjustifyleft : ['justifyleft_desc', 'JustifyLeft'],\n\t\t\tjustifycenter : ['justifycenter_desc', 'JustifyCenter'],\n\t\t\tjustifyright : ['justifyright_desc', 'JustifyRight'],\n\t\t\tjustifyfull : ['justifyfull_desc', 'JustifyFull'],\n\t\t\tbullist : ['bullist_desc', 'InsertUnorderedList'],\n\t\t\tnumlist : ['numlist_desc', 'InsertOrderedList'],\n\t\t\toutdent : ['outdent_desc', 'Outdent'],\n\t\t\tindent : ['indent_desc', 'Indent'],\n\t\t\tcut : ['cut_desc', 'Cut'],\n\t\t\tcopy : ['copy_desc', 'Copy'],\n\t\t\tpaste : ['paste_desc', 'Paste'],\n\t\t\tundo : ['undo_desc', 'Undo'],\n\t\t\tredo : ['redo_desc', 'Redo'],\n\t\t\tlink : ['link_desc', 'mceLink'],\n\t\t\tunlink : ['unlink_desc', 'unlink'],\n\t\t\timage : ['image_desc', 'mceImage'],\n\t\t\tcleanup : ['cleanup_desc', 'mceCleanup'],\n\t\t\thelp : ['help_desc', 'mceHelp'],\n\t\t\tcode : ['code_desc', 'mceCodeEditor'],\n\t\t\thr : ['hr_desc', 'InsertHorizontalRule'],\n\t\t\tremoveformat : ['removeformat_desc', 'RemoveFormat'],\n\t\t\tsub : ['sub_desc', 'subscript'],\n\t\t\tsup : ['sup_desc', 'superscript'],\n\t\t\tforecolor : ['forecolor_desc', 'ForeColor'],\n\t\t\tforecolorpicker : ['forecolor_desc', 'mceForeColor'],\n\t\t\tbackcolor : ['backcolor_desc', 'HiliteColor'],\n\t\t\tbackcolorpicker : ['backcolor_desc', 'mceBackColor'],\n\t\t\tcharmap : ['charmap_desc', 'mceCharMap'],\n\t\t\tvisualaid : ['visualaid_desc', 'mceToggleVisualAid'],\n\t\t\tanchor : ['anchor_desc', 'mceInsertAnchor'],\n\t\t\tnewdocument : ['newdocument_desc', 'mceNewDocument'],\n\t\t\tblockquote : ['blockquote_desc', 'mceBlockQuote']\n\t\t},\n\n\t\tstateControls : ['bold', 'italic', 'underline', 'strikethrough', 'bullist', 'numlist', 'justifyleft', 'justifycenter', 'justifyright', 'justifyfull', 'sub', 'sup', 'blockquote'],\n\n\t\tinit : function(ed, url) {\n\t\t\tvar t = this, s, v, o;\n\t\n\t\t\tt.editor = ed;\n\t\t\tt.url = url;\n\t\t\tt.onResolveName = new tinymce.util.Dispatcher(this);\n\n\t\t\ted.forcedHighContrastMode = ed.settings.detect_highcontrast && t._isHighContrast();\n\t\t\ted.settings.skin = ed.forcedHighContrastMode ? 'highcontrast' : ed.settings.skin;\n\n\t\t\t// Default settings\n\t\t\tt.settings = s = extend({\n\t\t\t\ttheme_advanced_path : true,\n\t\t\t\ttheme_advanced_toolbar_location : 'bottom',\n\t\t\t\ttheme_advanced_buttons1 : \"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,styleselect,formatselect\",\n\t\t\t\ttheme_advanced_buttons2 : \"bullist,numlist,|,outdent,indent,|,undo,redo,|,link,unlink,anchor,image,cleanup,help,code\",\n\t\t\t\ttheme_advanced_buttons3 : \"hr,removeformat,visualaid,|,sub,sup,|,charmap\",\n\t\t\t\ttheme_advanced_blockformats : \"p,address,pre,h1,h2,h3,h4,h5,h6\",\n\t\t\t\ttheme_advanced_toolbar_align : \"center\",\n\t\t\t\ttheme_advanced_fonts : \"Andale Mono=andale mono,times;Arial=arial,helvetica,sans-serif;Arial Black=arial black,avant garde;Book Antiqua=book antiqua,palatino;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier;Georgia=georgia,palatino;Helvetica=helvetica;Impact=impact,chicago;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco;Times New Roman=times new roman,times;Trebuchet MS=trebuchet ms,geneva;Verdana=verdana,geneva;Webdings=webdings;Wingdings=wingdings,zapf dingbats\",\n\t\t\t\ttheme_advanced_more_colors : 1,\n\t\t\t\ttheme_advanced_row_height : 23,\n\t\t\t\ttheme_advanced_resize_horizontal : 1,\n\t\t\t\ttheme_advanced_resizing_use_cookie : 1,\n\t\t\t\ttheme_advanced_font_sizes : \"1,2,3,4,5,6,7\",\n\t\t\t\ttheme_advanced_font_selector : \"span\",\n\t\t\t\ttheme_advanced_show_current_color: 0,\n\t\t\t\treadonly : ed.settings.readonly\n\t\t\t}, ed.settings);\n\n\t\t\t// Setup default font_size_style_values\n\t\t\tif (!s.font_size_style_values)\n\t\t\t\ts.font_size_style_values = \"8pt,10pt,12pt,14pt,18pt,24pt,36pt\";\n\n\t\t\tif (tinymce.is(s.theme_advanced_font_sizes, 'string')) {\n\t\t\t\ts.font_size_style_values = tinymce.explode(s.font_size_style_values);\n\t\t\t\ts.font_size_classes = tinymce.explode(s.font_size_classes || '');\n\n\t\t\t\t// Parse string value\n\t\t\t\to = {};\n\t\t\t\ted.settings.theme_advanced_font_sizes = s.theme_advanced_font_sizes;\n\t\t\t\teach(ed.getParam('theme_advanced_font_sizes', '', 'hash'), function(v, k) {\n\t\t\t\t\tvar cl;\n\n\t\t\t\t\tif (k == v && v >= 1 && v <= 7) {\n\t\t\t\t\t\tk = v + ' (' + t.sizes[v - 1] + 'pt)';\n\t\t\t\t\t\tcl = s.font_size_classes[v - 1];\n\t\t\t\t\t\tv = s.font_size_style_values[v - 1] || (t.sizes[v - 1] + 'pt');\n\t\t\t\t\t}\n\n\t\t\t\t\tif (/^\\s*\\./.test(v))\n\t\t\t\t\t\tcl = v.replace(/\\./g, '');\n\n\t\t\t\t\to[k] = cl ? {'class' : cl} : {fontSize : v};\n\t\t\t\t});\n\n\t\t\t\ts.theme_advanced_font_sizes = o;\n\t\t\t}\n\n\t\t\tif ((v = s.theme_advanced_path_location) && v != 'none')\n\t\t\t\ts.theme_advanced_statusbar_location = s.theme_advanced_path_location;\n\n\t\t\tif (s.theme_advanced_statusbar_location == 'none')\n\t\t\t\ts.theme_advanced_statusbar_location = 0;\n\n\t\t\tif (ed.settings.content_css !== false)\n\t\t\t\ted.contentCSS.push(ed.baseURI.toAbsolute(url + \"/skins/\" + ed.settings.skin + \"/content.css\"));\n\n\t\t\t// Init editor\n\t\t\ted.onInit.add(function() {\n\t\t\t\tif (!ed.settings.readonly) {\n\t\t\t\t\ted.onNodeChange.add(t._nodeChanged, t);\n\t\t\t\t\ted.onKeyUp.add(t._updateUndoStatus, t);\n\t\t\t\t\ted.onMouseUp.add(t._updateUndoStatus, t);\n\t\t\t\t\ted.dom.bind(ed.dom.getRoot(), 'dragend', function() {\n\t\t\t\t\t\tt._updateUndoStatus(ed);\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\ted.onSetProgressState.add(function(ed, b, ti) {\n\t\t\t\tvar co, id = ed.id, tb;\n\n\t\t\t\tif (b) {\n\t\t\t\t\tt.progressTimer = setTimeout(function() {\n\t\t\t\t\t\tco = ed.getContainer();\n\t\t\t\t\t\tco = co.insertBefore(DOM.create('DIV', {style : 'position:relative'}), co.firstChild);\n\t\t\t\t\t\ttb = DOM.get(ed.id + '_tbl');\n\n\t\t\t\t\t\tDOM.add(co, 'div', {id : id + '_blocker', 'class' : 'mceBlocker', style : {width : tb.clientWidth + 2, height : tb.clientHeight + 2}});\n\t\t\t\t\t\tDOM.add(co, 'div', {id : id + '_progress', 'class' : 'mceProgress', style : {left : tb.clientWidth / 2, top : tb.clientHeight / 2}});\n\t\t\t\t\t}, ti || 0);\n\t\t\t\t} else {\n\t\t\t\t\tDOM.remove(id + '_blocker');\n\t\t\t\t\tDOM.remove(id + '_progress');\n\t\t\t\t\tclearTimeout(t.progressTimer);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tDOM.loadCSS(s.editor_css ? ed.documentBaseURI.toAbsolute(s.editor_css) : url + \"/skins/\" + ed.settings.skin + \"/ui.css\");\n\n\t\t\tif (s.skin_variant)\n\t\t\t\tDOM.loadCSS(url + \"/skins/\" + ed.settings.skin + \"/ui_\" + s.skin_variant + \".css\");\n\t\t},\n\n\t\t_isHighContrast : function() {\n\t\t\tvar actualColor, div = DOM.add(DOM.getRoot(), 'div', {'style': 'background-color: rgb(171,239,86);'});\n\n\t\t\tactualColor = (DOM.getStyle(div, 'background-color', true) + '').toLowerCase().replace(/ /g, '');\n\t\t\tDOM.remove(div);\n\n\t\t\treturn actualColor != 'rgb(171,239,86)' && actualColor != '#abef56';\n\t\t},\n\n\t\tcreateControl : function(n, cf) {\n\t\t\tvar cd, c;\n\n\t\t\tif (c = cf.createControl(n))\n\t\t\t\treturn c;\n\n\t\t\tswitch (n) {\n\t\t\t\tcase \"styleselect\":\n\t\t\t\t\treturn this._createStyleSelect();\n\n\t\t\t\tcase \"formatselect\":\n\t\t\t\t\treturn this._createBlockFormats();\n\n\t\t\t\tcase \"fontselect\":\n\t\t\t\t\treturn this._createFontSelect();\n\n\t\t\t\tcase \"fontsizeselect\":\n\t\t\t\t\treturn this._createFontSizeSelect();\n\n\t\t\t\tcase \"forecolor\":\n\t\t\t\t\treturn this._createForeColorMenu();\n\n\t\t\t\tcase \"backcolor\":\n\t\t\t\t\treturn this._createBackColorMenu();\n\t\t\t}\n\n\t\t\tif ((cd = this.controls[n]))\n\t\t\t\treturn cf.createButton(n, {title : \"advanced.\" + cd[0], cmd : cd[1], ui : cd[2], value : cd[3]});\n\t\t},\n\n\t\texecCommand : function(cmd, ui, val) {\n\t\t\tvar f = this['_' + cmd];\n\n\t\t\tif (f) {\n\t\t\t\tf.call(this, ui, val);\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\n\t\t_importClasses : function(e) {\n\t\t\tvar ed = this.editor, ctrl = ed.controlManager.get('styleselect');\n\n\t\t\tif (ctrl.getLength() == 0) {\n\t\t\t\teach(ed.dom.getClasses(), function(o, idx) {\n\t\t\t\t\tvar name = 'style_' + idx;\n\n\t\t\t\t\ted.formatter.register(name, {\n\t\t\t\t\t\tinline : 'span',\n\t\t\t\t\t\tattributes : {'class' : o['class']},\n\t\t\t\t\t\tselector : '*'\n\t\t\t\t\t});\n\n\t\t\t\t\tctrl.add(o['class'], name);\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\t_createStyleSelect : function(n) {\n\t\t\tvar t = this, ed = t.editor, ctrlMan = ed.controlManager, ctrl;\n\n\t\t\t// Setup style select box\n\t\t\tctrl = ctrlMan.createListBox('styleselect', {\n\t\t\t\ttitle : 'advanced.style_select',\n\t\t\t\tonselect : function(name) {\n\t\t\t\t\tvar matches, formatNames = [];\n\n\t\t\t\t\teach(ctrl.items, function(item) {\n\t\t\t\t\t\tformatNames.push(item.value);\n\t\t\t\t\t});\n\n\t\t\t\t\ted.focus();\n\t\t\t\t\ted.undoManager.add();\n\n\t\t\t\t\t// Toggle off the current format\n\t\t\t\t\tmatches = ed.formatter.matchAll(formatNames);\n\t\t\t\t\tif (!name || matches[0] == name) {\n\t\t\t\t\t\tif (matches[0]) \n\t\t\t\t\t\t\ted.formatter.remove(matches[0]);\n\t\t\t\t\t} else\n\t\t\t\t\t\ted.formatter.apply(name);\n\n\t\t\t\t\ted.undoManager.add();\n\t\t\t\t\ted.nodeChanged();\n\n\t\t\t\t\treturn false; // No auto select\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Handle specified format\n\t\t\ted.onInit.add(function() {\n\t\t\t\tvar counter = 0, formats = ed.getParam('style_formats');\n\n\t\t\t\tif (formats) {\n\t\t\t\t\teach(formats, function(fmt) {\n\t\t\t\t\t\tvar name, keys = 0;\n\n\t\t\t\t\t\teach(fmt, function() {keys++;});\n\n\t\t\t\t\t\tif (keys > 1) {\n\t\t\t\t\t\t\tname = fmt.name = fmt.name || 'style_' + (counter++);\n\t\t\t\t\t\t\ted.formatter.register(name, fmt);\n\t\t\t\t\t\t\tctrl.add(fmt.title, name);\n\t\t\t\t\t\t} else\n\t\t\t\t\t\t\tctrl.add(fmt.title);\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\teach(ed.getParam('theme_advanced_styles', '', 'hash'), function(val, key) {\n\t\t\t\t\t\tvar name;\n\n\t\t\t\t\t\tif (val) {\n\t\t\t\t\t\t\tname = 'style_' + (counter++);\n\n\t\t\t\t\t\t\ted.formatter.register(name, {\n\t\t\t\t\t\t\t\tinline : 'span',\n\t\t\t\t\t\t\t\tclasses : val,\n\t\t\t\t\t\t\t\tselector : '*'\n\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\tctrl.add(t.editor.translate(key), name);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Auto import classes if the ctrl box is empty\n\t\t\tif (ctrl.getLength() == 0) {\n\t\t\t\tctrl.onPostRender.add(function(ed, n) {\n\t\t\t\t\tif (!ctrl.NativeListBox) {\n\t\t\t\t\t\tEvent.add(n.id + '_text', 'focus', t._importClasses, t);\n\t\t\t\t\t\tEvent.add(n.id + '_text', 'mousedown', t._importClasses, t);\n\t\t\t\t\t\tEvent.add(n.id + '_open', 'focus', t._importClasses, t);\n\t\t\t\t\t\tEvent.add(n.id + '_open', 'mousedown', t._importClasses, t);\n\t\t\t\t\t} else\n\t\t\t\t\t\tEvent.add(n.id, 'focus', t._importClasses, t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn ctrl;\n\t\t},\n\n\t\t_createFontSelect : function() {\n\t\t\tvar c, t = this, ed = t.editor;\n\n\t\t\tc = ed.controlManager.createListBox('fontselect', {\n\t\t\t\ttitle : 'advanced.fontdefault',\n\t\t\t\tonselect : function(v) {\n\t\t\t\t\tvar cur = c.items[c.selectedIndex];\n\n\t\t\t\t\tif (!v && cur) {\n\t\t\t\t\t\ted.execCommand('FontName', false, cur.value);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\ted.execCommand('FontName', false, v);\n\n\t\t\t\t\t// Fake selection, execCommand will fire a nodeChange and update the selection\n\t\t\t\t\tc.select(function(sv) {\n\t\t\t\t\t\treturn v == sv;\n\t\t\t\t\t});\n\n\t\t\t\t\tif (cur && cur.value == v) {\n\t\t\t\t\t\tc.select(null);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false; // No auto select\n\t\t\t\t}\n\t\t\t});\n\n\t\t\tif (c) {\n\t\t\t\teach(ed.getParam('theme_advanced_fonts', t.settings.theme_advanced_fonts, 'hash'), function(v, k) {\n\t\t\t\t\tc.add(ed.translate(k), v, {style : v.indexOf('dings') == -1 ? 'font-family:' + v : ''});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn c;\n\t\t},\n\n\t\t_createFontSizeSelect : function() {\n\t\t\tvar t = this, ed = t.editor, c, i = 0, cl = [];\n\n\t\t\tc = ed.controlManager.createListBox('fontsizeselect', {title : 'advanced.font_size', onselect : function(v) {\n\t\t\t\tvar cur = c.items[c.selectedIndex];\n\n\t\t\t\tif (!v && cur) {\n\t\t\t\t\tcur = cur.value;\n\n\t\t\t\t\tif (cur['class']) {\n\t\t\t\t\t\ted.formatter.toggle('fontsize_class', {value : cur['class']});\n\t\t\t\t\t\ted.undoManager.add();\n\t\t\t\t\t\ted.nodeChanged();\n\t\t\t\t\t} else {\n\t\t\t\t\t\ted.execCommand('FontSize', false, cur.fontSize);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (v['class']) {\n\t\t\t\t\ted.focus();\n\t\t\t\t\ted.undoManager.add();\n\t\t\t\t\ted.formatter.toggle('fontsize_class', {value : v['class']});\n\t\t\t\t\ted.undoManager.add();\n\t\t\t\t\ted.nodeChanged();\n\t\t\t\t} else\n\t\t\t\t\ted.execCommand('FontSize', false, v.fontSize);\n\n\t\t\t\t// Fake selection, execCommand will fire a nodeChange and update the selection\n\t\t\t\tc.select(function(sv) {\n\t\t\t\t\treturn v == sv;\n\t\t\t\t});\n\n\t\t\t\tif (cur && (cur.value.fontSize == v.fontSize || cur.value['class'] == v['class'])) {\n\t\t\t\t\tc.select(null);\n\t\t\t\t}\n\n\t\t\t\treturn false; // No auto select\n\t\t\t}});\n\n\t\t\tif (c) {\n\t\t\t\teach(t.settings.theme_advanced_font_sizes, function(v, k) {\n\t\t\t\t\tvar fz = v.fontSize;\n\n\t\t\t\t\tif (fz >= 1 && fz <= 7)\n\t\t\t\t\t\tfz = t.sizes[parseInt(fz) - 1] + 'pt';\n\n\t\t\t\t\tc.add(k, v, {'style' : 'font-size:' + fz, 'class' : 'mceFontSize' + (i++) + (' ' + (v['class'] || ''))});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn c;\n\t\t},\n\n\t\t_createBlockFormats : function() {\n\t\t\tvar c, fmts = {\n\t\t\t\tp : 'advanced.paragraph',\n\t\t\t\taddress : 'advanced.address',\n\t\t\t\tpre : 'advanced.pre',\n\t\t\t\th1 : 'advanced.h1',\n\t\t\t\th2 : 'advanced.h2',\n\t\t\t\th3 : 'advanced.h3',\n\t\t\t\th4 : 'advanced.h4',\n\t\t\t\th5 : 'advanced.h5',\n\t\t\t\th6 : 'advanced.h6',\n\t\t\t\tdiv : 'advanced.div',\n\t\t\t\tblockquote : 'advanced.blockquote',\n\t\t\t\tcode : 'advanced.code',\n\t\t\t\tdt : 'advanced.dt',\n\t\t\t\tdd : 'advanced.dd',\n\t\t\t\tsamp : 'advanced.samp'\n\t\t\t}, t = this;\n\n\t\t\tc = t.editor.controlManager.createListBox('formatselect', {title : 'advanced.block', onselect : function(v) {\n\t\t\t\tt.editor.execCommand('FormatBlock', false, v);\n\t\t\t\treturn false;\n\t\t\t}});\n\n\t\t\tif (c) {\n\t\t\t\teach(t.editor.getParam('theme_advanced_blockformats', t.settings.theme_advanced_blockformats, 'hash'), function(v, k) {\n\t\t\t\t\tc.add(t.editor.translate(k != v ? k : fmts[v]), v, {'class' : 'mce_formatPreview mce_' + v});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\treturn c;\n\t\t},\n\n\t\t_createForeColorMenu : function() {\n\t\t\tvar c, t = this, s = t.settings, o = {}, v;\n\n\t\t\tif (s.theme_advanced_more_colors) {\n\t\t\t\to.more_colors_func = function() {\n\t\t\t\t\tt._mceColorPicker(0, {\n\t\t\t\t\t\tcolor : c.value,\n\t\t\t\t\t\tfunc : function(co) {\n\t\t\t\t\t\t\tc.setColor(co);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (v = s.theme_advanced_text_colors)\n\t\t\t\to.colors = v;\n\n\t\t\tif (s.theme_advanced_default_foreground_color)\n\t\t\t\to.default_color = s.theme_advanced_default_foreground_color;\n\n\t\t\to.title = 'advanced.forecolor_desc';\n\t\t\to.cmd = 'ForeColor';\n\t\t\to.scope = this;\n\n\t\t\tc = t.editor.controlManager.createColorSplitButton('forecolor', o);\n\n\t\t\treturn c;\n\t\t},\n\n\t\t_createBackColorMenu : function() {\n\t\t\tvar c, t = this, s = t.settings, o = {}, v;\n\n\t\t\tif (s.theme_advanced_more_colors) {\n\t\t\t\to.more_colors_func = function() {\n\t\t\t\t\tt._mceColorPicker(0, {\n\t\t\t\t\t\tcolor : c.value,\n\t\t\t\t\t\tfunc : function(co) {\n\t\t\t\t\t\t\tc.setColor(co);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tif (v = s.theme_advanced_background_colors)\n\t\t\t\to.colors = v;\n\n\t\t\tif (s.theme_advanced_default_background_color)\n\t\t\t\to.default_color = s.theme_advanced_default_background_color;\n\n\t\t\to.title = 'advanced.backcolor_desc';\n\t\t\to.cmd = 'HiliteColor';\n\t\t\to.scope = this;\n\n\t\t\tc = t.editor.controlManager.createColorSplitButton('backcolor', o);\n\n\t\t\treturn c;\n\t\t},\n\n\t\trenderUI : function(o) {\n\t\t\tvar n, ic, tb, t = this, ed = t.editor, s = t.settings, sc, p, nl;\n\n\t\t\tif (ed.settings) {\n\t\t\t\ted.settings.aria_label = s.aria_label + ed.getLang('advanced.help_shortcut');\n\t\t\t}\n\n\t\t\t// TODO: ACC Should have an aria-describedby attribute which is user-configurable to describe what this field is actually for.\n\t\t\t// Maybe actually inherit it from the original textara?\n\t\t\tn = p = DOM.create('span', {role : 'application', 'aria-labelledby' : ed.id + '_voice', id : ed.id + '_parent', 'class' : 'mceEditor ' + ed.settings.skin + 'Skin' + (s.skin_variant ? ' ' + ed.settings.skin + 'Skin' + t._ufirst(s.skin_variant) : '')});\n\t\t\tDOM.add(n, 'span', {'class': 'mceVoiceLabel', 'style': 'display:none;', id: ed.id + '_voice'}, s.aria_label);\n\n\t\t\tif (!DOM.boxModel)\n\t\t\t\tn = DOM.add(n, 'div', {'class' : 'mceOldBoxModel'});\n\n\t\t\tn = sc = DOM.add(n, 'table', {role : \"presentation\", id : ed.id + '_tbl', 'class' : 'mceLayout', cellSpacing : 0, cellPadding : 0});\n\t\t\tn = tb = DOM.add(n, 'tbody');\n\n\t\t\tswitch ((s.theme_advanced_layout_manager || '').toLowerCase()) {\n\t\t\t\tcase \"rowlayout\":\n\t\t\t\t\tic = t._rowLayout(s, tb, o);\n\t\t\t\t\tbreak;\n\n\t\t\t\tcase \"customlayout\":\n\t\t\t\t\tic = ed.execCallback(\"theme_advanced_custom_layout\", s, tb, o, p);\n\t\t\t\t\tbreak;\n\n\t\t\t\tdefault:\n\t\t\t\t\tic = t._simpleLayout(s, tb, o, p);\n\t\t\t}\n\n\t\t\tn = o.targetNode;\n\n\t\t\t// Add classes to first and last TRs\n\t\t\tnl = sc.rows;\n\t\t\tDOM.addClass(nl[0], 'mceFirst');\n\t\t\tDOM.addClass(nl[nl.length - 1], 'mceLast');\n\n\t\t\t// Add classes to first and last TDs\n\t\t\teach(DOM.select('tr', tb), function(n) {\n\t\t\t\tDOM.addClass(n.firstChild, 'mceFirst');\n\t\t\t\tDOM.addClass(n.childNodes[n.childNodes.length - 1], 'mceLast');\n\t\t\t});\n\n\t\t\tif (DOM.get(s.theme_advanced_toolbar_container))\n\t\t\t\tDOM.get(s.theme_advanced_toolbar_container).appendChild(p);\n\t\t\telse\n\t\t\t\tDOM.insertAfter(p, n);\n\n\t\t\tEvent.add(ed.id + '_path_row', 'click', function(e) {\n\t\t\t\te = e.target;\n\n\t\t\t\tif (e.nodeName == 'A') {\n\t\t\t\t\tt._sel(e.className.replace(/^.*mcePath_([0-9]+).*$/, '$1'));\n\n\t\t\t\t\treturn Event.cancel(e);\n\t\t\t\t}\n\t\t\t});\n/*\n\t\t\tif (DOM.get(ed.id + '_path_row')) {\n\t\t\t\tEvent.add(ed.id + '_tbl', 'mouseover', function(e) {\n\t\t\t\t\tvar re;\n\t\n\t\t\t\t\te = e.target;\n\n\t\t\t\t\tif (e.nodeName == 'SPAN' && DOM.hasClass(e.parentNode, 'mceButton')) {\n\t\t\t\t\t\tre = DOM.get(ed.id + '_path_row');\n\t\t\t\t\t\tt.lastPath = re.innerHTML;\n\t\t\t\t\t\tDOM.setHTML(re, e.parentNode.title);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tEvent.add(ed.id + '_tbl', 'mouseout', function(e) {\n\t\t\t\t\tif (t.lastPath) {\n\t\t\t\t\t\tDOM.setHTML(ed.id + '_path_row', t.lastPath);\n\t\t\t\t\t\tt.lastPath = 0;\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n*/\n\n\t\t\tif (!ed.getParam('accessibility_focus'))\n\t\t\t\tEvent.add(DOM.add(p, 'a', {href : '#'}, '<!-- IE -->'), 'focus', function() {tinyMCE.get(ed.id).focus();});\n\n\t\t\tif (s.theme_advanced_toolbar_location == 'external')\n\t\t\t\to.deltaHeight = 0;\n\n\t\t\tt.deltaHeight = o.deltaHeight;\n\t\t\to.targetNode = null;\n\n\t\t\ted.onKeyDown.add(function(ed, evt) {\n\t\t\t\tvar DOM_VK_F10 = 121, DOM_VK_F11 = 122;\n\n\t\t\t\tif (evt.altKey) {\n\t\t \t\t\tif (evt.keyCode === DOM_VK_F10) {\n\t\t\t\t\t\t// Make sure focus is given to toolbar in Safari.\n\t\t\t\t\t\t// We can't do this in IE as it prevents giving focus to toolbar when editor is in a frame\n\t\t\t\t\t\tif (tinymce.isWebKit) {\n\t\t\t\t\t\t\twindow.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tt.toolbarGroup.focus();\n\t\t\t\t\t\treturn Event.cancel(evt);\n\t\t\t\t\t} else if (evt.keyCode === DOM_VK_F11) {\n\t\t\t\t\t\tDOM.get(ed.id + '_path_row').focus();\n\t\t\t\t\t\treturn Event.cancel(evt);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// alt+0 is the UK recommended shortcut for accessing the list of access controls.\n\t\t\ted.addShortcut('alt+0', '', 'mceShortcuts', t);\n\n\t\t\treturn {\n\t\t\t\tiframeContainer : ic,\n\t\t\t\teditorContainer : ed.id + '_parent',\n\t\t\t\tsizeContainer : sc,\n\t\t\t\tdeltaHeight : o.deltaHeight\n\t\t\t};\n\t\t},\n\n\t\tgetInfo : function() {\n\t\t\treturn {\n\t\t\t\tlongname : 'Advanced theme',\n\t\t\t\tauthor : 'Moxiecode Systems AB',\n\t\t\t\tauthorurl : 'http://tinymce.moxiecode.com',\n\t\t\t\tversion : tinymce.majorVersion + \".\" + tinymce.minorVersion\n\t\t\t}\n\t\t},\n\n\t\tresizeBy : function(dw, dh) {\n\t\t\tvar e = DOM.get(this.editor.id + '_ifr');\n\n\t\t\tthis.resizeTo(e.clientWidth + dw, e.clientHeight + dh);\n\t\t},\n\n\t\tresizeTo : function(w, h, store) {\n\t\t\tvar ed = this.editor, s = this.settings, e = DOM.get(ed.id + '_tbl'), ifr = DOM.get(ed.id + '_ifr');\n\n\t\t\t// Boundery fix box\n\t\t\tw = Math.max(s.theme_advanced_resizing_min_width || 100, w);\n\t\t\th = Math.max(s.theme_advanced_resizing_min_height || 100, h);\n\t\t\tw = Math.min(s.theme_advanced_resizing_max_width || 0xFFFF, w);\n\t\t\th = Math.min(s.theme_advanced_resizing_max_height || 0xFFFF, h);\n\n\t\t\t// Resize iframe and container\n\t\t\tDOM.setStyle(e, 'height', '');\n\t\t\tDOM.setStyle(ifr, 'height', h);\n\n\t\t\tif (s.theme_advanced_resize_horizontal) {\n\t\t\t\tDOM.setStyle(e, 'width', '');\n\t\t\t\tDOM.setStyle(ifr, 'width', w);\n\n\t\t\t\t// Make sure that the size is never smaller than the over all ui\n\t\t\t\tif (w < e.clientWidth) {\n\t\t\t\t\tw = e.clientWidth;\n\t\t\t\t\tDOM.setStyle(ifr, 'width', e.clientWidth);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Store away the size\n\t\t\tif (store && s.theme_advanced_resizing_use_cookie) {\n\t\t\t\tCookie.setHash(\"TinyMCE_\" + ed.id + \"_size\", {\n\t\t\t\t\tcw : w,\n\t\t\t\t\tch : h\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tdestroy : function() {\n\t\t\tvar id = this.editor.id;\n\n\t\t\tEvent.clear(id + '_resize');\n\t\t\tEvent.clear(id + '_path_row');\n\t\t\tEvent.clear(id + '_external_close');\n\t\t},\n\n\t\t// Internal functions\n\n\t\t_simpleLayout : function(s, tb, o, p) {\n\t\t\tvar t = this, ed = t.editor, lo = s.theme_advanced_toolbar_location, sl = s.theme_advanced_statusbar_location, n, ic, etb, c;\n\n\t\t\tif (s.readonly) {\n\t\t\t\tn = DOM.add(tb, 'tr');\n\t\t\t\tn = ic = DOM.add(n, 'td', {'class' : 'mceIframeContainer'});\n\t\t\t\treturn ic;\n\t\t\t}\n\n\t\t\t// Create toolbar container at top\n\t\t\tif (lo == 'top')\n\t\t\t\tt._addToolbars(tb, o);\n\n\t\t\t// Create external toolbar\n\t\t\tif (lo == 'external') {\n\t\t\t\tn = c = DOM.create('div', {style : 'position:relative'});\n\t\t\t\tn = DOM.add(n, 'div', {id : ed.id + '_external', 'class' : 'mceExternalToolbar'});\n\t\t\t\tDOM.add(n, 'a', {id : ed.id + '_external_close', href : 'javascript:;', 'class' : 'mceExternalClose'});\n\t\t\t\tn = DOM.add(n, 'table', {id : ed.id + '_tblext', cellSpacing : 0, cellPadding : 0});\n\t\t\t\tetb = DOM.add(n, 'tbody');\n\n\t\t\t\tif (p.firstChild.className == 'mceOldBoxModel')\n\t\t\t\t\tp.firstChild.appendChild(c);\n\t\t\t\telse\n\t\t\t\t\tp.insertBefore(c, p.firstChild);\n\n\t\t\t\tt._addToolbars(etb, o);\n\n\t\t\t\ted.onMouseUp.add(function() {\n\t\t\t\t\tvar e = DOM.get(ed.id + '_external');\n\t\t\t\t\tDOM.show(e);\n\n\t\t\t\t\tDOM.hide(lastExtID);\n\n\t\t\t\t\tvar f = Event.add(ed.id + '_external_close', 'click', function() {\n\t\t\t\t\t\tDOM.hide(ed.id + '_external');\n\t\t\t\t\t\tEvent.remove(ed.id + '_external_close', 'click', f);\n\t\t\t\t\t});\n\n\t\t\t\t\tDOM.show(e);\n\t\t\t\t\tDOM.setStyle(e, 'top', 0 - DOM.getRect(ed.id + '_tblext').h - 1);\n\n\t\t\t\t\t// Fixes IE rendering bug\n\t\t\t\t\tDOM.hide(e);\n\t\t\t\t\tDOM.show(e);\n\t\t\t\t\te.style.filter = '';\n\n\t\t\t\t\tlastExtID = ed.id + '_external';\n\n\t\t\t\t\te = null;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tif (sl == 'top')\n\t\t\t\tt._addStatusBar(tb, o);\n\n\t\t\t// Create iframe container\n\t\t\tif (!s.theme_advanced_toolbar_container) {\n\t\t\t\tn = DOM.add(tb, 'tr');\n\t\t\t\tn = ic = DOM.add(n, 'td', {'class' : 'mceIframeContainer'});\n\t\t\t}\n\n\t\t\t// Create toolbar container at bottom\n\t\t\tif (lo == 'bottom')\n\t\t\t\tt._addToolbars(tb, o);\n\n\t\t\tif (sl == 'bottom')\n\t\t\t\tt._addStatusBar(tb, o);\n\n\t\t\treturn ic;\n\t\t},\n\n\t\t_rowLayout : function(s, tb, o) {\n\t\t\tvar t = this, ed = t.editor, dc, da, cf = ed.controlManager, n, ic, to, a;\n\n\t\t\tdc = s.theme_advanced_containers_default_class || '';\n\t\t\tda = s.theme_advanced_containers_default_align || 'center';\n\n\t\t\teach(explode(s.theme_advanced_containers || ''), function(c, i) {\n\t\t\t\tvar v = s['theme_advanced_container_' + c] || '';\n\n\t\t\t\tswitch (c.toLowerCase()) {\n\t\t\t\t\tcase 'mceeditor':\n\t\t\t\t\t\tn = DOM.add(tb, 'tr');\n\t\t\t\t\t\tn = ic = DOM.add(n, 'td', {'class' : 'mceIframeContainer'});\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tcase 'mceelementpath':\n\t\t\t\t\t\tt._addStatusBar(tb, o);\n\t\t\t\t\t\tbreak;\n\n\t\t\t\t\tdefault:\n\t\t\t\t\t\ta = (s['theme_advanced_container_' + c + '_align'] || da).toLowerCase();\n\t\t\t\t\t\ta = 'mce' + t._ufirst(a);\n\n\t\t\t\t\t\tn = DOM.add(DOM.add(tb, 'tr'), 'td', {\n\t\t\t\t\t\t\t'class' : 'mceToolbar ' + (s['theme_advanced_container_' + c + '_class'] || dc) + ' ' + a || da\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tto = cf.createToolbar(\"toolbar\" + i);\n\t\t\t\t\t\tt._addControls(v, to);\n\t\t\t\t\t\tDOM.setHTML(n, to.renderHTML());\n\t\t\t\t\t\to.deltaHeight -= s.theme_advanced_row_height;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn ic;\n\t\t},\n\n\t\t_addControls : function(v, tb) {\n\t\t\tvar t = this, s = t.settings, di, cf = t.editor.controlManager;\n\n\t\t\tif (s.theme_advanced_disable && !t._disabled) {\n\t\t\t\tdi = {};\n\n\t\t\t\teach(explode(s.theme_advanced_disable), function(v) {\n\t\t\t\t\tdi[v] = 1;\n\t\t\t\t});\n\n\t\t\t\tt._disabled = di;\n\t\t\t} else\n\t\t\t\tdi = t._disabled;\n\n\t\t\teach(explode(v), function(n) {\n\t\t\t\tvar c;\n\n\t\t\t\tif (di && di[n])\n\t\t\t\t\treturn;\n\n\t\t\t\t// Compatiblity with 2.x\n\t\t\t\tif (n == 'tablecontrols') {\n\t\t\t\t\teach([\"table\",\"|\",\"row_props\",\"cell_props\",\"|\",\"row_before\",\"row_after\",\"delete_row\",\"|\",\"col_before\",\"col_after\",\"delete_col\",\"|\",\"split_cells\",\"merge_cells\"], function(n) {\n\t\t\t\t\t\tn = t.createControl(n, cf);\n\n\t\t\t\t\t\tif (n)\n\t\t\t\t\t\t\ttb.add(n);\n\t\t\t\t\t});\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tc = t.createControl(n, cf);\n\n\t\t\t\tif (c)\n\t\t\t\t\ttb.add(c);\n\t\t\t});\n\t\t},\n\n\t\t_addToolbars : function(c, o) {\n\t\t\tvar t = this, i, tb, ed = t.editor, s = t.settings, v, cf = ed.controlManager, di, n, h = [], a, toolbarGroup;\n\n\t\t\ttoolbarGroup = cf.createToolbarGroup('toolbargroup', {\n\t\t\t\t'name': ed.getLang('advanced.toolbar'),\n\t\t\t\t'tab_focus_toolbar':ed.getParam('theme_advanced_tab_focus_toolbar')\n\t\t\t});\n\n\t\t\tt.toolbarGroup = toolbarGroup;\n\n\t\t\ta = s.theme_advanced_toolbar_align.toLowerCase();\n\t\t\ta = 'mce' + t._ufirst(a);\n\n\t\t\tn = DOM.add(DOM.add(c, 'tr', {role: 'presentation'}), 'td', {'class' : 'mceToolbar ' + a, \"role\":\"presentation\"});\n\n\t\t\t// Create toolbar and add the controls\n\t\t\tfor (i=1; (v = s['theme_advanced_buttons' + i]); i++) {\n\t\t\t\ttb = cf.createToolbar(\"toolbar\" + i, {'class' : 'mceToolbarRow' + i});\n\n\t\t\t\tif (s['theme_advanced_buttons' + i + '_add'])\n\t\t\t\t\tv += ',' + s['theme_advanced_buttons' + i + '_add'];\n\n\t\t\t\tif (s['theme_advanced_buttons' + i + '_add_before'])\n\t\t\t\t\tv = s['theme_advanced_buttons' + i + '_add_before'] + ',' + v;\n\n\t\t\t\tt._addControls(v, tb);\n\t\t\t\ttoolbarGroup.add(tb);\n\n\t\t\t\to.deltaHeight -= s.theme_advanced_row_height;\n\t\t\t}\n\t\t\th.push(toolbarGroup.renderHTML());\n\t\t\th.push(DOM.createHTML('a', {href : '#', accesskey : 'z', title : ed.getLang(\"advanced.toolbar_focus\"), onfocus : 'tinyMCE.getInstanceById(\\'' + ed.id + '\\').focus();'}, '<!-- IE -->'));\n\t\t\tDOM.setHTML(n, h.join(''));\n\t\t},\n\n\t\t_addStatusBar : function(tb, o) {\n\t\t\tvar n, t = this, ed = t.editor, s = t.settings, r, mf, me, td;\n\n\t\t\tn = DOM.add(tb, 'tr');\n\t\t\tn = td = DOM.add(n, 'td', {'class' : 'mceStatusbar'}); \n\t\t\tn = DOM.add(n, 'div', {id : ed.id + '_path_row', 'role': 'group', 'aria-labelledby': ed.id + '_path_voice'});\n\t\t\tif (s.theme_advanced_path) {\n\t\t\t\tDOM.add(n, 'span', {id: ed.id + '_path_voice'}, ed.translate('advanced.path'));\n\t\t\t\tDOM.add(n, 'span', {}, ': ');\n\t\t\t} else {\n\t\t\t\tDOM.add(n, 'span', {}, '&#160;');\n\t\t\t}\n\t\t\t\n\n\t\t\tif (s.theme_advanced_resizing) {\n\t\t\t\tDOM.add(td, 'a', {id : ed.id + '_resize', href : 'javascript:;', onclick : \"return false;\", 'class' : 'mceResize', tabIndex:\"-1\"});\n\n\t\t\t\tif (s.theme_advanced_resizing_use_cookie) {\n\t\t\t\t\ted.onPostRender.add(function() {\n\t\t\t\t\t\tvar o = Cookie.getHash(\"TinyMCE_\" + ed.id + \"_size\"), c = DOM.get(ed.id + '_tbl');\n\n\t\t\t\t\t\tif (!o)\n\t\t\t\t\t\t\treturn;\n\n\t\t\t\t\t\tt.resizeTo(o.cw, o.ch);\n\t\t\t\t\t});\n\t\t\t\t}\n\n\t\t\t\ted.onPostRender.add(function() {\n\t\t\t\t\tEvent.add(ed.id + '_resize', 'click', function(e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t});\n\n\t\t\t\t\tEvent.add(ed.id + '_resize', 'mousedown', function(e) {\n\t\t\t\t\t\tvar mouseMoveHandler1, mouseMoveHandler2,\n\t\t\t\t\t\t\tmouseUpHandler1, mouseUpHandler2,\n\t\t\t\t\t\t\tstartX, startY, startWidth, startHeight, width, height, ifrElm;\n\n\t\t\t\t\t\tfunction resizeOnMove(e) {\n\t\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t\twidth = startWidth + (e.screenX - startX);\n\t\t\t\t\t\t\theight = startHeight + (e.screenY - startY);\n\n\t\t\t\t\t\t\tt.resizeTo(width, height);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tfunction endResize(e) {\n\t\t\t\t\t\t\t// Stop listening\n\t\t\t\t\t\t\tEvent.remove(DOM.doc, 'mousemove', mouseMoveHandler1);\n\t\t\t\t\t\t\tEvent.remove(ed.getDoc(), 'mousemove', mouseMoveHandler2);\n\t\t\t\t\t\t\tEvent.remove(DOM.doc, 'mouseup', mouseUpHandler1);\n\t\t\t\t\t\t\tEvent.remove(ed.getDoc(), 'mouseup', mouseUpHandler2);\n\n\t\t\t\t\t\t\twidth = startWidth + (e.screenX - startX);\n\t\t\t\t\t\t\theight = startHeight + (e.screenY - startY);\n\t\t\t\t\t\t\tt.resizeTo(width, height, true);\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t// Get the current rect size\n\t\t\t\t\t\tstartX = e.screenX;\n\t\t\t\t\t\tstartY = e.screenY;\n\t\t\t\t\t\tifrElm = DOM.get(t.editor.id + '_ifr');\n\t\t\t\t\t\tstartWidth = width = ifrElm.clientWidth;\n\t\t\t\t\t\tstartHeight = height = ifrElm.clientHeight;\n\n\t\t\t\t\t\t// Register envent handlers\n\t\t\t\t\t\tmouseMoveHandler1 = Event.add(DOM.doc, 'mousemove', resizeOnMove);\n\t\t\t\t\t\tmouseMoveHandler2 = Event.add(ed.getDoc(), 'mousemove', resizeOnMove);\n\t\t\t\t\t\tmouseUpHandler1 = Event.add(DOM.doc, 'mouseup', endResize);\n\t\t\t\t\t\tmouseUpHandler2 = Event.add(ed.getDoc(), 'mouseup', endResize);\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t}\n\n\t\t\to.deltaHeight -= 21;\n\t\t\tn = tb = null;\n\t\t},\n\n\t\t_updateUndoStatus : function(ed) {\n\t\t\tvar cm = ed.controlManager, um = ed.undoManager;\n\n\t\t\tcm.setDisabled('undo', !um.hasUndo() && !um.typing);\n\t\t\tcm.setDisabled('redo', !um.hasRedo());\n\t\t},\n\n\t\t_nodeChanged : function(ed, cm, n, co, ob) {\n\t\t\tvar t = this, p, de = 0, v, c, s = t.settings, cl, fz, fn, fc, bc, formatNames, matches;\n\n\t\t\ttinymce.each(t.stateControls, function(c) {\n\t\t\t\tcm.setActive(c, ed.queryCommandState(t.controls[c][1]));\n\t\t\t});\n\n\t\t\tfunction getParent(name) {\n\t\t\t\tvar i, parents = ob.parents, func = name;\n\n\t\t\t\tif (typeof(name) == 'string') {\n\t\t\t\t\tfunc = function(node) {\n\t\t\t\t\t\treturn node.nodeName == name;\n\t\t\t\t\t};\n\t\t\t\t}\n\n\t\t\t\tfor (i = 0; i < parents.length; i++) {\n\t\t\t\t\tif (func(parents[i]))\n\t\t\t\t\t\treturn parents[i];\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tcm.setActive('visualaid', ed.hasVisual);\n\t\t\tt._updateUndoStatus(ed);\n\t\t\tcm.setDisabled('outdent', !ed.queryCommandState('Outdent'));\n\n\t\t\tp = getParent('A');\n\t\t\tif (c = cm.get('link')) {\n\t\t\t\tif (!p || !p.name) {\n\t\t\t\t\tc.setDisabled(!p && co);\n\t\t\t\t\tc.setActive(!!p);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif (c = cm.get('unlink')) {\n\t\t\t\tc.setDisabled(!p && co);\n\t\t\t\tc.setActive(!!p && !p.name);\n\t\t\t}\n\n\t\t\tif (c = cm.get('anchor')) {\n\t\t\t\tc.setActive(!co && !!p && p.name);\n\t\t\t}\n\n\t\t\tp = getParent('IMG');\n\t\t\tif (c = cm.get('image'))\n\t\t\t\tc.setActive(!co && !!p && n.className.indexOf('mceItem') == -1);\n\n\t\t\tif (c = cm.get('styleselect')) {\n\t\t\t\tt._importClasses();\n\n\t\t\t\tformatNames = [];\n\t\t\t\teach(c.items, function(item) {\n\t\t\t\t\tformatNames.push(item.value);\n\t\t\t\t});\n\n\t\t\t\tmatches = ed.formatter.matchAll(formatNames);\n\t\t\t\tc.select(matches[0]);\n\t\t\t}\n\n\t\t\tif (c = cm.get('formatselect')) {\n\t\t\t\tp = getParent(DOM.isBlock);\n\n\t\t\t\tif (p)\n\t\t\t\t\tc.select(p.nodeName.toLowerCase());\n\t\t\t}\n\n\t\t\t// Find out current fontSize, fontFamily and fontClass\n\t\t\tgetParent(function(n) {\n\t\t\t\tif (n.nodeName === 'SPAN') {\n\t\t\t\t\tif (!cl && n.className)\n\t\t\t\t\t\tcl = n.className;\n\t\t\t\t}\n\n\t\t\t\tif (ed.dom.is(n, s.theme_advanced_font_selector)) {\n\t\t\t\t\tif (!fz && n.style.fontSize)\n\t\t\t\t\t\tfz = n.style.fontSize;\n\n\t\t\t\t\tif (!fn && n.style.fontFamily)\n\t\t\t\t\t\tfn = n.style.fontFamily.replace(/[\\\"\\']+/g, '').replace(/^([^,]+).*/, '$1').toLowerCase();\n\t\t\t\t\t\n\t\t\t\t\tif (!fc && n.style.color)\n\t\t\t\t\t\tfc = n.style.color;\n\n\t\t\t\t\tif (!bc && n.style.backgroundColor)\n\t\t\t\t\t\tbc = n.style.backgroundColor;\n\t\t\t\t}\n\n\t\t\t\treturn false;\n\t\t\t});\n\n\t\t\tif (c = cm.get('fontselect')) {\n\t\t\t\tc.select(function(v) {\n\t\t\t\t\treturn v.replace(/^([^,]+).*/, '$1').toLowerCase() == fn;\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Select font size\n\t\t\tif (c = cm.get('fontsizeselect')) {\n\t\t\t\t// Use computed style\n\t\t\t\tif (s.theme_advanced_runtime_fontsize && !fz && !cl)\n\t\t\t\t\tfz = ed.dom.getStyle(n, 'fontSize', true);\n\n\t\t\t\tc.select(function(v) {\n\t\t\t\t\tif (v.fontSize && v.fontSize === fz)\n\t\t\t\t\t\treturn true;\n\n\t\t\t\t\tif (v['class'] && v['class'] === cl)\n\t\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t}\n\t\t\t\n\t\t\tif (s.theme_advanced_show_current_color) {\n\t\t\t\tfunction updateColor(controlId, color) {\n\t\t\t\t\tif (c = cm.get(controlId)) {\n\t\t\t\t\t\tif (!color)\n\t\t\t\t\t\t\tcolor = c.settings.default_color;\n\t\t\t\t\t\tif (color !== c.value) {\n\t\t\t\t\t\t\tc.displayColor(color);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tupdateColor('forecolor', fc);\n\t\t\t\tupdateColor('backcolor', bc);\n\t\t\t}\n\n\t\t\tif (s.theme_advanced_show_current_color) {\n\t\t\t\tfunction updateColor(controlId, color) {\n\t\t\t\t\tif (c = cm.get(controlId)) {\n\t\t\t\t\t\tif (!color)\n\t\t\t\t\t\t\tcolor = c.settings.default_color;\n\t\t\t\t\t\tif (color !== c.value) {\n\t\t\t\t\t\t\tc.displayColor(color);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t};\n\n\t\t\t\tupdateColor('forecolor', fc);\n\t\t\t\tupdateColor('backcolor', bc);\n\t\t\t}\n\n\t\t\tif (s.theme_advanced_path && s.theme_advanced_statusbar_location) {\n\t\t\t\tp = DOM.get(ed.id + '_path') || DOM.add(ed.id + '_path_row', 'span', {id : ed.id + '_path'});\n\n\t\t\t\tif (t.statusKeyboardNavigation) {\n\t\t\t\t\tt.statusKeyboardNavigation.destroy();\n\t\t\t\t\tt.statusKeyboardNavigation = null;\n\t\t\t\t}\n\n\t\t\t\tDOM.setHTML(p, '');\n\n\t\t\t\tgetParent(function(n) {\n\t\t\t\t\tvar na = n.nodeName.toLowerCase(), u, pi, ti = '';\n\n\t\t\t\t\t// Ignore non element and bogus/hidden elements\n\t\t\t\t\tif (n.nodeType != 1 || na === 'br' || n.getAttribute('data-mce-bogus') || DOM.hasClass(n, 'mceItemHidden') || DOM.hasClass(n, 'mceItemRemoved'))\n\t\t\t\t\t\treturn;\n\n\t\t\t\t\t// Handle prefix\n\t\t\t\t\tif (tinymce.isIE && n.scopeName !== 'HTML')\n\t\t\t\t\t\tna = n.scopeName + ':' + na;\n\n\t\t\t\t\t// Remove internal prefix\n\t\t\t\t\tna = na.replace(/mce\\:/g, '');\n\n\t\t\t\t\t// Handle node name\n\t\t\t\t\tswitch (na) {\n\t\t\t\t\t\tcase 'b':\n\t\t\t\t\t\t\tna = 'strong';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'i':\n\t\t\t\t\t\t\tna = 'em';\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'img':\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'src'))\n\t\t\t\t\t\t\t\tti += 'src: ' + v + ' ';\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'a':\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'name')) {\n\t\t\t\t\t\t\t\tti += 'name: ' + v + ' ';\n\t\t\t\t\t\t\t\tna += '#' + v;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'href'))\n\t\t\t\t\t\t\t\tti += 'href: ' + v + ' ';\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'font':\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'face'))\n\t\t\t\t\t\t\t\tti += 'font: ' + v + ' ';\n\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'size'))\n\t\t\t\t\t\t\t\tti += 'size: ' + v + ' ';\n\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'color'))\n\t\t\t\t\t\t\t\tti += 'color: ' + v + ' ';\n\n\t\t\t\t\t\t\tbreak;\n\n\t\t\t\t\t\tcase 'span':\n\t\t\t\t\t\t\tif (v = DOM.getAttrib(n, 'style'))\n\t\t\t\t\t\t\t\tti += 'style: ' + v + ' ';\n\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (v = DOM.getAttrib(n, 'id'))\n\t\t\t\t\t\tti += 'id: ' + v + ' ';\n\n\t\t\t\t\tif (v = n.className) {\n\t\t\t\t\t\tv = v.replace(/\\b\\s*(webkit|mce|Apple-)\\w+\\s*\\b/g, '')\n\n\t\t\t\t\t\tif (v) {\n\t\t\t\t\t\t\tti += 'class: ' + v + ' ';\n\n\t\t\t\t\t\t\tif (DOM.isBlock(n) || na == 'img' || na == 'span')\n\t\t\t\t\t\t\t\tna += '.' + v;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tna = na.replace(/(html:)/g, '');\n\t\t\t\t\tna = {name : na, node : n, title : ti};\n\t\t\t\t\tt.onResolveName.dispatch(t, na);\n\t\t\t\t\tti = na.title;\n\t\t\t\t\tna = na.name;\n\n\t\t\t\t\t//u = \"javascript:tinymce.EditorManager.get('\" + ed.id + \"').theme._sel('\" + (de++) + \"');\";\n\t\t\t\t\tpi = DOM.create('a', {'href' : \"javascript:;\", role: 'button', onmousedown : \"return false;\", title : ti, 'class' : 'mcePath_' + (de++)}, na);\n\n\t\t\t\t\tif (p.hasChildNodes()) {\n\t\t\t\t\t\tp.insertBefore(DOM.create('span', {'aria-hidden': 'true'}, '\\u00a0\\u00bb '), p.firstChild);\n\t\t\t\t\t\tp.insertBefore(pi, p.firstChild);\n\t\t\t\t\t} else\n\t\t\t\t\t\tp.appendChild(pi);\n\t\t\t\t}, ed.getBody());\n\n\t\t\t\tif (DOM.select('a', p).length > 0) {\n\t\t\t\t\tt.statusKeyboardNavigation = new tinymce.ui.KeyboardNavigation({\n\t\t\t\t\t\troot: ed.id + \"_path_row\",\n\t\t\t\t\t\titems: DOM.select('a', p),\n\t\t\t\t\t\texcludeFromTabOrder: true,\n\t\t\t\t\t\tonCancel: function() {\n\t\t\t\t\t\t\ted.focus();\n\t\t\t\t\t\t}\n\t\t\t\t\t}, DOM);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\n\t\t// Commands gets called by execCommand\n\n\t\t_sel : function(v) {\n\t\t\tthis.editor.execCommand('mceSelectNodeDepth', false, v);\n\t\t},\n\n\t\t_mceInsertAnchor : function(ui, v) {\n\t\t\tvar ed = this.editor;\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/anchor.htm',\n\t\t\t\twidth : 320 + parseInt(ed.getLang('advanced.anchor_delta_width', 0)),\n\t\t\t\theight : 90 + parseInt(ed.getLang('advanced.anchor_delta_height', 0)),\n\t\t\t\tinline : true\n\t\t\t}, {\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceCharMap : function() {\n\t\t\tvar ed = this.editor;\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/charmap.htm',\n\t\t\t\twidth : 550 + parseInt(ed.getLang('advanced.charmap_delta_width', 0)),\n\t\t\t\theight : 260 + parseInt(ed.getLang('advanced.charmap_delta_height', 0)),\n\t\t\t\tinline : true\n\t\t\t}, {\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceHelp : function() {\n\t\t\tvar ed = this.editor;\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/about.htm',\n\t\t\t\twidth : 480,\n\t\t\t\theight : 380,\n\t\t\t\tinline : true\n\t\t\t}, {\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceShortcuts : function() {\n\t\t\tvar ed = this.editor;\n\t\t\ted.windowManager.open({\n\t\t\t\turl: this.url + '/shortcuts.htm',\n\t\t\t\twidth: 480,\n\t\t\t\theight: 380,\n\t\t\t\tinline: true\n\t\t\t}, {\n\t\t\t\ttheme_url: this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceColorPicker : function(u, v) {\n\t\t\tvar ed = this.editor;\n\n\t\t\tv = v || {};\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/color_picker.htm',\n\t\t\t\twidth : 375 + parseInt(ed.getLang('advanced.colorpicker_delta_width', 0)),\n\t\t\t\theight : 250 + parseInt(ed.getLang('advanced.colorpicker_delta_height', 0)),\n\t\t\t\tclose_previous : false,\n\t\t\t\tinline : true\n\t\t\t}, {\n\t\t\t\tinput_color : v.color,\n\t\t\t\tfunc : v.func,\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceCodeEditor : function(ui, val) {\n\t\t\tvar ed = this.editor;\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/source_editor.htm',\n\t\t\t\twidth : parseInt(ed.getParam(\"theme_advanced_source_editor_width\", 720)),\n\t\t\t\theight : parseInt(ed.getParam(\"theme_advanced_source_editor_height\", 580)),\n\t\t\t\tinline : true,\n\t\t\t\tresizable : true,\n\t\t\t\tmaximizable : true\n\t\t\t}, {\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceImage : function(ui, val) {\n\t\t\tvar ed = this.editor;\n\n\t\t\t// Internal image object like a flash placeholder\n\t\t\tif (ed.dom.getAttrib(ed.selection.getNode(), 'class').indexOf('mceItem') != -1)\n\t\t\t\treturn;\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/image.htm',\n\t\t\t\twidth : 355 + parseInt(ed.getLang('advanced.image_delta_width', 0)),\n\t\t\t\theight : 275 + parseInt(ed.getLang('advanced.image_delta_height', 0)),\n\t\t\t\tinline : true\n\t\t\t}, {\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceLink : function(ui, val) {\n\t\t\tvar ed = this.editor;\n\n\t\t\ted.windowManager.open({\n\t\t\t\turl : this.url + '/link.htm',\n\t\t\t\twidth : 310 + parseInt(ed.getLang('advanced.link_delta_width', 0)),\n\t\t\t\theight : 200 + parseInt(ed.getLang('advanced.link_delta_height', 0)),\n\t\t\t\tinline : true\n\t\t\t}, {\n\t\t\t\ttheme_url : this.url\n\t\t\t});\n\t\t},\n\n\t\t_mceNewDocument : function() {\n\t\t\tvar ed = this.editor;\n\n\t\t\ted.windowManager.confirm('advanced.newdocument', function(s) {\n\t\t\t\tif (s)\n\t\t\t\t\ted.execCommand('mceSetContent', false, '');\n\t\t\t});\n\t\t},\n\n\t\t_mceForeColor : function() {\n\t\t\tvar t = this;\n\n\t\t\tthis._mceColorPicker(0, {\n\t\t\t\tcolor: t.fgColor,\n\t\t\t\tfunc : function(co) {\n\t\t\t\t\tt.fgColor = co;\n\t\t\t\t\tt.editor.execCommand('ForeColor', false, co);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t_mceBackColor : function() {\n\t\t\tvar t = this;\n\n\t\t\tthis._mceColorPicker(0, {\n\t\t\t\tcolor: t.bgColor,\n\t\t\t\tfunc : function(co) {\n\t\t\t\t\tt.bgColor = co;\n\t\t\t\t\tt.editor.execCommand('HiliteColor', false, co);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t_ufirst : function(s) {\n\t\t\treturn s.substring(0, 1).toUpperCase() + s.substring(1);\n\t\t}\n\t});\n\n\ttinymce.ThemeManager.add('advanced', tinymce.themes.AdvancedTheme);\n}(tinymce));\n"}
}});
